!function(){function a(a,b,c){var d=function(){};if(d.prototype=b.prototype,a.prototype=new d,a.super=b.prototype,a.prototype.constructor=a,c)for(var e in c)a.prototype[e]=c[e]}function b(){}function c(a,b){for(var c in b){var d=b[c];if(!(d in a))throw new Error("Required option "+d+"not found")}}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}function e(a,b){if(!e)throw new Error("Assertion Failed: "+b)}function f(a){return"string"==typeof a&&null!==a.match(/^(\s*)$/)}function g(a){c(a,["canvas","analyser"]),this.canvas=a.canvas,this.analyser=a.analyser,this._initGl()}function h(){}function i(a,b){this.vertexSrc=a,this.fragmentSrc=b}function j(a){var b=["attribute vec2 a_texCoord;","varying vec2 v_texCoord;","void main() {","    v_texCoord = a_texCoord;","    gl_Position = vec4((a_texCoord*2.0)-1.0, 0, 1);","}"].join("\n");j.super.constructor.call(this,b,a)}function k(){}function l(a,b){this.codeSrc=a,this.externalVars=b?b:[],this._parseSrc()}function m(){}function n(a,b,c){this.operator=a,this.leftOperand=b,this.rightOperand=c}function o(a,b){this.operator=a,this.operand=b}function p(a,b){this.funcName=a,this.args=b}function q(a,b){this.identifier=a,this.expr=b}function r(a){this.statements=a}function s(a){this.value=a}function t(a){var b;switch(a){case F.REPLACE:b="src";break;case F.MAXIMUM:b="max(src, dest)";break;case F.ADDITIVE:b="clamp(src+dest, vec4(0,0,0,0), vec4(1,1,1,1))";break;default:throw new Error("Invalid copy blend mode")}var c=["precision mediump float;","uniform sampler2D u_curRender;",a!=F.REPLACE?"uniform sampler2D u_destTexture;":"","varying vec2 v_texCoord;","void main() {",a!=F.REPLACE?"vec4 dest = texture2D(u_destTexture, v_texCoord);":"","   vec4 src = texture2D(u_curRender, v_texCoord);","   gl_FragColor = "+b+";","}"].join("\n");t.super.constructor.call(this,c)}function u(a){c(a,["components"]),this._constructComponent(a.components),this.output=a.output?F[a.output]:F.REPLACE,this.clearFrame=a.clearFrame?a.clearFrame:!1,this.first=!0,u.super.constructor.call(this)}function v(a){this.dancer=a,this.beat=!1;var b=this;this.kick=a.createKick({onKick:function(){b.beat=!0},offKick:function(){b.beat=!1}}),this.kick.on()}function w(a){if(a=a?a:{},this.n=a.n?a.n:1,this.color=a.color?a.color:[0,0,0],3!=this.color.length)throw new Error("Invalid clear color, must be an array of 3");for(var b=0;b<this.color.length;b++)this.color[b]=this.color[b]/255;this.blend=a.blend?a.blend:!1,this.prevBeat=!1,this.beatCount=0;var c=["attribute vec2 a_position;","void main() {","   gl_Position = vec4(a_position, 0, 1);","}"].join("\n"),d=["precision mediump float;","uniform vec3 u_color;","void main() {","   gl_FragColor = vec4(u_color, 1);","}"].join("\n");w.super.constructor.call(this,c,d)}function x(a){c(a,["src","x","y"]),this.src=a.src,this.x=a.x,this.y=a.y;var b=["attribute vec2 a_texCoord;","varying vec2 v_texCoord;","uniform vec2 u_resolution;","uniform vec2 u_imageResolution;","uniform vec2 u_imagePos;","void main() {","    v_texCoord = a_texCoord*vec2(1,-1);","    vec2 clipSpace = ((a_texCoord*u_imageResolution+u_imagePos)/u_resolution)*2.0-1.0;","    gl_Position = vec4(clipSpace*vec2(1, -1), 0, 1);","}"].join("\n"),d=["precision mediump float;","uniform sampler2D u_image;","varying vec2 v_texCoord;","void main() {","   gl_FragColor = texture2D(u_image, v_texCoord);","}"].join("\n");x.super.constructor.call(this,b,d)}function y(a){c(a,["code"]);var b;if(a.code in y.examples)b=y.examples[a.code]();else{if("object"!=typeof a.code)throw new Error("Invalid superscope");b=a.code}var d=new l(b,["n","v","i","x","y","b","w","h","red","green","blue"]);this.code=d.generateJs(["init","onBeat","perFrame","perPoint"]),this.code.n=100,this.spectrum=a.spectrum?a.spectrum:!1,this.dots=a.dots?a.dots:!1;for(var e=a.colors?a.colors:[[255,255,255]],f=0;f<e.length;f++){if(3!=e[f].length)throw new Error("Invalid color, must be an array of 3");for(var g=0;3>g;g++)e[f][g]=e[f][g]/255}this.colors=e,this.currentColor=e[0],this.maxStep=100,this.step=this.maxStep,this.colorId=0,this.colorStep=[0,0,0],this.thickness=a.thickness?a.thickness:1,this.inited=!1;var h=["attribute vec2 a_position;","attribute vec3 a_color;","varying vec3 v_color;","uniform float u_pointSize;","void main() {","   gl_PointSize = u_pointSize;","   gl_Position = vec4(clamp(a_position, vec2(-1,-1), vec2(1,1)), 0, 1);","   v_color = a_color;","}"].join("\n"),i=["precision mediump float;","varying vec3 v_color;","void main() {","   gl_FragColor = vec4(v_color, 1);","}"].join("\n");y.super.constructor.call(this,h,i)}function z(a){c(a,["kernel"]);var b=["precision mediump float;","uniform vec2 u_resolution;","uniform sampler2D u_curRender;","varying vec2 v_texCoord;","uniform float u_kernel[9];","uniform float u_kernelWeight;","void main() {","   vec2 onePixel = vec2(1.0, 1.0)/u_resolution;","   vec4 colorSum = texture2D(u_curRender, v_texCoord + onePixel * vec2(-1, 1)) * u_kernel[0] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(0, -1)) * u_kernel[1] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(1, -1)) * u_kernel[2] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(-1, 0)) * u_kernel[3] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(0, 0))  * u_kernel[4] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(1, 0))  * u_kernel[5] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(-1, 1)) * u_kernel[6] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(0, 1))  * u_kernel[7] + ","                   texture2D(u_curRender, v_texCoord + onePixel * vec2(1, 1))  * u_kernel[8];","   gl_FragColor = vec4((colorSum / u_kernelWeight).rgb, 1.0);","}"].join("\n");if(a.kernel in z.kernels)this.kernel=z.kernels[a.kernel];else{if(!d(a.kernel)||9!=a.kernel.length)throw new Error("Invalid convolution kernel");this.kernel=a.kernel}for(var e=0,f=0;f<this.kernel.length;f++)e+=this.kernel[f];this.kernelWeight=e,z.super.constructor.call(this,b)}function A(a){c(a,["code"]),a=_.defaults(a,{gridW:16,gridH:16,coord:"POLAR"});var b;if(a.code in A.examples)b=A.examples[a.code];else{if("object"!=typeof a.code)throw new Error("Invalid Dynamic movement code");b=a.code}var d=new l(b,["x","y","r","d","b","w","h"]);this.code=d.generateJs(["init","onBeat","perFrame"]),this.inited=!1,this.gridW=a.gridW,this.gridH=a.gridH,this.coordMode=a.coord;var e="";"POLAR"===this.coordMode&&(e=["d = distance(a_position, vec2(0,0));","r = atan(a_position.x, a_position.y);"].join("\n"));var f="";"POLAR"===this.coordMode&&(f=["x = d*sin(r);","y = -d*cos(r);"].join("\n"));var g=["precision mediump float;","attribute vec2 a_position;","varying vec2 v_newPoint;","uniform vec2 u_resolution;","uniform int u_coordMode;",d.generateGlsl(["perPixel"],["x","y","d","r"]),"void main() {","   x = a_position.x;","   y = -a_position.y;",e,"   perPixel();",f,"   v_newPoint = vec2(x,-y);","   gl_Position = vec4(a_position, 0, 1);","}"].join("\n"),h=["precision mediump float;","varying vec2 v_newPoint;","uniform sampler2D u_curRender;","void main() {","   gl_FragColor = vec4(texture2D(u_curRender, mod((v_newPoint+1.0)/2.0, 1.0)).rgb, 1);","}"].join("\n");console.log(g),A.super.constructor.call(this,g,h)}function B(a){if(a=a?a:{},this.speed=a.speed?a.speed:1,this.color=a.color?a.color:[0,0,0],3!=this.color.length)throw new Error("Invalid clear color, must be an array of 3");for(var b=0;b<this.color.length;b++)this.color[b]=this.color[b]/255;this.frameCount=0,this.maxFrameCount=Math.floor(1/this.speed);var c=["attribute vec2 a_position;","void main() {","   gl_Position = vec4(a_position, 0, 1);","}"].join("\n"),d=["precision mediump float;","uniform vec3 u_color;","void main() {","   gl_FragColor = vec4(u_color, 1);","}"].join("\n");B.super.constructor.call(this,c,d)}var C=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)},E=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(a){return window.clearTimeout(a)};_.flatMap=_.compose(_.flatten,_.map),a(g,Object,{_initGl:function(){try{this.gl=this.canvas.getContext("experimental-webgl"),this.resolution={width:this.canvas.width,height:this.canvas.height}}catch(a){throw new Error("Couldnt get webgl context"+a)}},loadPreset:function(a){this.preset=a,this.stop(),this.rootComponent&&this.rootComponent.destroyComponent(),this.rootComponent=new u(a)},resetCanvas:function(){this.stop(),this.rootComponent&&(this.rootComponent.destroyComponent(),this.rootComponent=null),this._initGl(),this.preset&&(this.rootComponent=new u(this.preset))},start:function(){if(this.rootComponent){var a=this.rootComponent,b=a.initComponent(this.gl,this.resolution,this.analyser),c=this,d=function(){c.analyser.isPlaying()&&a.updateComponent(),c.animReqId=C(d)};b.then(function(){c.animReqId=C(d)})}},stop:function(){"undefined"!=typeof this.animReqId&&E(this.animReqId)}}),a(h,Object,{swapFrame:!1,initComponent:function(a,b,c){this.gl=a,this.resolution=b,this.analyser=c},updateComponent:function(){},destroyComponent:function(){}}),a(i,h,{swapFrame:!1,initComponent:function(a,b,c){i.super.initComponent.call(this,a,b,c),this._compileProgram(this.vertexSrc,this.fragmentSrc),this.resolutionLocation=this.gl.getUniformLocation(this.program,"u_resolution"),this.init()},updateComponent:function(){i.super.updateComponent.apply(this,arguments),this.gl.uniform2f(this.resolutionLocation,this.resolution.width,this.resolution.height),this.update.apply(this,arguments)},destroyComponent:function(){var a=this.gl;a.deleteShader(this.vertex),a.deleteShader(this.fragment),a.deleteProgram(this.program)},_compileProgram:function(a,b){var c=this.gl,d=this._compileShader(a,c.VERTEX_SHADER),e=this._compileShader(b,c.FRAGMENT_SHADER),f=c.createProgram();if(c.attachShader(f,d),c.attachShader(f,e),c.linkProgram(f),!c.getProgramParameter(f,c.LINK_STATUS))throw new Error("Program link Error: "+c.getProgramInfoLog(f));this.vertex=d,this.fragment=e,this.program=f},_compileShader:function(a,b){var c=this.gl,d=c.createShader(b);if(c.shaderSource(d,a),c.compileShader(d),!c.getShaderParameter(d,c.COMPILE_STATUS))throw new Error("Shader compilation Error: "+c.getShaderInfoLog(d));return d}}),a(j,i,{swapFrame:!0,destroyComponent:function(){j.super.destroyComponent.call(this);var a=this.gl;a.deleteBuffer(this.texCoordBuffer)},init:function(){var a=this.gl;this.texCoordBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),a.STATIC_DRAW),this.vertexPositionLocation=a.getAttribLocation(this.program,"a_texCoord"),this.curRenderLocation=a.getUniformLocation(this.program,"u_curRender")},update:function(a){var b=this.gl;b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,a),b.uniform1i(this.curRenderLocation,0),b.bindBuffer(b.ARRAY_BUFFER,this.texCoordBuffer),b.enableVertexAttribArray(this.vertexPositionLocation),b.vertexAttribPointer(this.vertexPositionLocation,2,b.FLOAT,!1,0,0),b.drawArrays(b.TRIANGLES,0,6)}});var F={REPLACE:1,MAXIMUM:2,ADDITIVE:3};window.Webvs=g,a(k,Object,{rand:function(a){return Math.random()*a},bindUniforms:function(a,b){_.each(this,function(c,d){if("number"==typeof c){var e=a.getUniformLocation(b,d);a.uniform1f(e,c)}})}}),a(l,Object,{_parseSrc:function(){var a={},b={};for(var c in this.codeSrc)try{a[c]=g.PegExprParser.parse(this.codeSrc[c]),b[c]=_.uniq(this._getVars(a[c]))}catch(d){throw new Error("Error parsing "+c+" : "+d)}this.codeAst=a;var e=[];for(var f in b)for(var h in b)h!=f&&(e=e.concat(_.intersection(b[f],b[h])));this.instanceVars=_.uniq(this.externalVars.concat(e));var i={};for(var j in b)i[j]=_.difference(b[j],this.instanceVars);this.localVars=i},generateJs:function(a){var c=new k,d=this;return _.each(this.instanceVars,function(a){c[a]=0}),_.each(this.codeAst,function(b,e){if(_.contains(a,e)){var f=d._generateJs(b,d.localVars[e]);c[e]=new Function(f)}}),_.each(_.difference(a,_.functions(c)),function(a){c[a]=b}),c},generateGlsl:function(a,b){var c=[],d=this;return _.each(this.instanceVars,function(a){var d="";_.contains(b,a)||(d="uniform "),c.push(d+"float "+a+";")}),_.each(this.codeAst,function(b,e){if(_.contains(a,e)){var f=d._generateGlsl(b,d.localVars[e]);c.push("void "+e+"() {"),c.push(f),c.push("}")}}),_.each(_.difference(a,_.keys(this.codeAst)),function(a){c.push("void "+a+"() {}")}),c.join("\n")},_generateGlsl:function(a,b){var c=this;if(a instanceof n)return"("+this._generateGlsl(a.leftOperand)+a.operator+this._generateGlsl(a.rightOperand)+")";if(a instanceof o)return"("+a.operator+this._generateGlsl(a.operand)+")";if(a instanceof p){var d=_.map(a.args,function(a){return c._generateGlsl(a)}).join(",");return"("+this._translateGlslFuncName(a.funcName)+"("+d+"))"}if(a instanceof q)return a.identifier+"="+this._generateGlsl(a.expr);if(a instanceof r){var e=_.map(b,function(a){return"float "+a+"=0.0"}),f=_.map(a.statements,function(a){return c._generateGlsl(a)});return e.concat(f).join(";\n")+";"}if(a instanceof s){var g="";return"number"==typeof a.value&&0===a.value%1&&(g=".0"),a.value.toString()+g}},_generateJs:function(a,b){var c,d=this;if(a instanceof n)return"("+this._generateJs(a.leftOperand)+a.operator+this._generateJs(a.rightOperand)+")";if(a instanceof o)return"("+a.operator+this._generateJs(a.operand)+")";if(a instanceof p){var e=_.map(a.args,function(a){return d._generateJs(a)}).join(",");return"("+this._translateJsFuncName(a.funcName)+"("+e+"))"}if(a instanceof q)return c="",_.contains(this.instanceVars,a.identifier)&&(c="this."),c+a.identifier+"="+this._generateJs(a.expr);if(a instanceof r){var f=_.map(b,function(a){return"var "+a+"=0"}),g=_.map(a.statements,function(a){return d._generateJs(a)});return f.concat(g).join(";\n")}return a instanceof s?(c="","string"==typeof a.value&&_.contains(this.instanceVars,a.value)&&(c="this."),c+a.value.toString()):void 0},_getVars:function(a){var b=this;if(a instanceof n){var c=this._getVars(a.leftOperand),d=this._getVars(a.rightOperand);return c.concat(d)}if(a instanceof o)return this._getVars(a.operand);if(a instanceof p)return _.map(a.args,function(a){return b._getVars(a)});if(a instanceof q){var e=this._getVars(a.expr);return e.concat(a.identifier)}return a instanceof r?_.flatMap(a.statements,function(a){return b._getVars(a)}):a instanceof s?"string"==typeof a.value?[a.value]:[]:void 0},_translateGlslFuncName:function(a){switch(a){case"sin":return"sin";case"cos":return"cos";case"tan":return"tan";case"asin":return"asin";case"acos":return"acos";case"atan":return"atan";case"log":return"log"}},_translateJsFuncName:function(a){switch(a){case"sin":return"Math.sin";case"cos":return"Math.cos";case"tan":return"Math.tan";case"asin":return"Math.asin";case"acos":return"Math.acos";case"atan":return"Math.atan";case"log":return"Math.log";case"rand":return"this.rand"}}}),window.Webvs.ExprCodeGenerator=l,a(m,Object),a(n,m),a(o,m),a(p,m),a(q,m),a(r,m),a(s,m),g.PegExprParser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var b={parse:function(b,c){function d(a){G>E||(E>G&&(G=E,H=[]),H.push(a))}function e(){var a,c,e,h,i,j,k,l,m,n,o;if(m=E,n=E,a=g(),null!==a){for(c=[],e=z();null!==e;)c.push(e),e=z();if(null!==c){if(e=[],o=E,59===b.charCodeAt(E)?(h=";",E++):(h=null,0===F&&d('";"')),null!==h){for(i=[],j=z();null!==j;)i.push(j),j=z();if(null!==i)if(j=g(),null!==j){for(k=[],l=z();null!==l;)k.push(l),l=z();null!==k?h=[h,i,j,k]:(h=null,E=o)}else h=null,E=o;else h=null,E=o}else h=null,E=o;for(;null!==h;)if(e.push(h),o=E,59===b.charCodeAt(E)?(h=";",E++):(h=null,0===F&&d('";"')),null!==h){for(i=[],j=z();null!==j;)i.push(j),j=z();if(null!==i)if(j=g(),null!==j){for(k=[],l=z();null!==l;)k.push(l),l=z();null!==k?h=[h,i,j,k]:(h=null,E=o)}else h=null,E=o;else h=null,E=o}else h=null,E=o;null!==e?(59===b.charCodeAt(E)?(h=";",E++):(h=null,0===F&&d('";"')),h=null!==h?h:"",null!==h?a=[a,c,e,h]:(a=null,E=n)):(a=null,E=n)}else a=null,E=n}else a=null,E=n;return null!==a&&(a=function(a,b){var c=_.reject(_.flatten(b),function(a){return f(a)||";"==a});return new r(c)}(m,a)),null===a&&(E=m),a}function g(){var a,c,e,f,g,h,i;if(h=E,i=E,a=x(),null!==a){for(c=[],e=z();null!==e;)c.push(e),e=z();if(null!==c)if(61===b.charCodeAt(E)?(e="=",E++):(e=null,0===F&&d('"="')),null!==e){for(f=[],g=z();null!==g;)f.push(g),g=z();null!==f?(g=l(),null!==g?a=[a,c,e,f,g]:(a=null,E=i)):(a=null,E=i)}else a=null,E=i;else a=null,E=i}else a=null,E=i;return null!==a&&(a=function(a,b,c){return new q(b,c)}(h,a[0],a[4])),null===a&&(E=h),null===a&&(a=l()),a}function h(){var a;return 43===b.charCodeAt(E)?(a="+",E++):(a=null,0===F&&d('"+"')),null===a&&(45===b.charCodeAt(E)?(a="-",E++):(a=null,0===F&&d('"-"'))),a}function i(){var a;return 43===b.charCodeAt(E)?(a="+",E++):(a=null,0===F&&d('"+"')),null===a&&(45===b.charCodeAt(E)?(a="-",E++):(a=null,0===F&&d('"-"'))),a}function j(){var a;return 42===b.charCodeAt(E)?(a="*",E++):(a=null,0===F&&d('"*"')),null===a&&(47===b.charCodeAt(E)?(a="/",E++):(a=null,0===F&&d('"/"')),null===a&&(37===b.charCodeAt(E)?(a="%",E++):(a=null,0===F&&d('"%"')))),a}function k(){var a;return 38===b.charCodeAt(E)?(a="&",E++):(a=null,0===F&&d('"&"')),null===a&&(124===b.charCodeAt(E)?(a="|",E++):(a=null,0===F&&d('"|"'))),a}function l(){var a,b,c,d,e,f,g,h,i;if(g=E,h=E,a=m(),null!==a){for(b=[],i=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=k(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=m(),null!==f?c=[c,d,e,f]:(c=null,E=i)):(c=null,E=i)}else c=null,E=i;else c=null,E=i;for(;null!==c;){for(b.push(c),i=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=k(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=m(),null!==f?c=[c,d,e,f]:(c=null,E=i)):(c=null,E=i)}else c=null,E=i;else c=null,E=i}null!==b?a=[a,b]:(a=null,E=h)}else a=null,E=h;return null!==a&&(a=function(a,b,c){return C(b,c)}(g,a[0],a[1])),null===a&&(E=g),a}function m(){var a,b,c,d,e,f,g,h,j;if(g=E,h=E,a=t(),null!==a){for(b=[],j=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=i(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=t(),null!==f?c=[c,d,e,f]:(c=null,E=j)):(c=null,E=j)}else c=null,E=j;else c=null,E=j;for(;null!==c;){for(b.push(c),j=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=i(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=t(),null!==f?c=[c,d,e,f]:(c=null,E=j)):(c=null,E=j)}else c=null,E=j;else c=null,E=j}null!==b?a=[a,b]:(a=null,E=h)}else a=null,E=h;return null!==a&&(a=function(a,b,c){return C(b,c)}(g,a[0],a[1])),null===a&&(E=g),a}function t(){var a,b,c,d,e,f,g,h,i;if(g=E,h=E,a=u(),null!==a){for(b=[],i=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=j(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=u(),null!==f?c=[c,d,e,f]:(c=null,E=i)):(c=null,E=i)}else c=null,E=i;else c=null,E=i;for(;null!==c;){for(b.push(c),i=E,c=[],d=z();null!==d;)c.push(d),d=z();if(null!==c)if(d=j(),null!==d){for(e=[],f=z();null!==f;)e.push(f),f=z();null!==e?(f=u(),null!==f?c=[c,d,e,f]:(c=null,E=i)):(c=null,E=i)}else c=null,E=i;else c=null,E=i}null!==b?a=[a,b]:(a=null,E=h)}else a=null,E=h;return null!==a&&(a=function(a,b,c){return C(b,c)}(g,a[0],a[1])),null===a&&(E=g),a}function u(){var a,b,c,d,e;if(d=E,e=E,a=h(),null!==a){for(b=[],c=z();null!==c;)b.push(c),c=z();null!==b?(c=v(),null!==c?a=[a,b,c]:(a=null,E=e)):(a=null,E=e)}else a=null,E=e;return null!==a&&(a=function(a,b,c){return new o(b,c)}(d,a[0],a[2])),null===a&&(E=d),null===a&&(a=v()),a}function v(){var a,c,e,g,h,i,j,k,m,n,o,q;if(m=E,n=E,a=x(),null!==a){for(c=[],e=z();null!==e;)c.push(e),e=z();if(null!==c)if(40===b.charCodeAt(E)?(e="(",E++):(e=null,0===F&&d('"("')),null!==e){for(g=[],h=z();null!==h;)g.push(h),h=z();if(null!==g){if(o=E,h=[],q=E,i=l(),null!==i){for(j=[],k=z();null!==k;)j.push(k),k=z();null!==j?(44===b.charCodeAt(E)?(k=",",E++):(k=null,0===F&&d('","')),null!==k?i=[i,j,k]:(i=null,E=q)):(i=null,E=q)}else i=null,E=q;for(;null!==i;)if(h.push(i),q=E,i=l(),null!==i){for(j=[],k=z();null!==k;)j.push(k),k=z();null!==j?(44===b.charCodeAt(E)?(k=",",E++):(k=null,0===F&&d('","')),null!==k?i=[i,j,k]:(i=null,E=q)):(i=null,E=q)}else i=null,E=q;if(null!==h){for(i=[],j=z();null!==j;)i.push(j),j=z();null!==i?(j=l(),null!==j?h=[h,i,j]:(h=null,E=o)):(h=null,E=o)}else h=null,E=o;if(h=null!==h?h:"",null!==h){for(i=[],j=z();null!==j;)i.push(j),j=z();null!==i?(41===b.charCodeAt(E)?(j=")",E++):(j=null,0===F&&d('")"')),null!==j?a=[a,c,e,g,h,i,j]:(a=null,E=n)):(a=null,E=n)}else a=null,E=n}else a=null,E=n}else a=null,E=n;else a=null,E=n}else a=null,E=n;return null!==a&&(a=function(a,b,c){var d=_.reject(_.flatten(c),function(a){return f(a)||","==a});return new p(b,d)}(m,a[0],a[4])),null===a&&(E=m),null===a&&(a=w()),a}function w(){var a,c,e,f,g;return f=E,a=y(),null!==a&&(a=function(a,b){return new s(b)}(f,a)),null===a&&(E=f),null===a&&(f=E,a=x(),null!==a&&(a=function(a,b){return new s(b)}(f,a)),null===a&&(E=f),null===a&&(f=E,g=E,40===b.charCodeAt(E)?(a="(",E++):(a=null,0===F&&d('"("')),null!==a?(c=l(),null!==c?(41===b.charCodeAt(E)?(e=")",E++):(e=null,0===F&&d('")"')),null!==e?a=[a,c,e]:(a=null,E=g)):(a=null,E=g)):(a=null,E=g),null!==a&&(a=function(a,b){return b}(f,a[1])),null===a&&(E=f))),a}function x(){var a,c,e,f,g;if(f=E,g=E,/^[a-zA-Z_]/.test(b.charAt(E))?(a=b.charAt(E),E++):(a=null,0===F&&d("[a-zA-Z_]")),null!==a){for(c=[],/^[a-zA-Z_0-9]/.test(b.charAt(E))?(e=b.charAt(E),E++):(e=null,0===F&&d("[a-zA-Z_0-9]"));null!==e;)c.push(e),/^[a-zA-Z_0-9]/.test(b.charAt(E))?(e=b.charAt(E),E++):(e=null,0===F&&d("[a-zA-Z_0-9]"));null!==c?a=[a,c]:(a=null,E=g)}else a=null,E=g;return null!==a&&(a=function(a,b){return _.flatten(b).join("").toLowerCase()}(f,a)),null===a&&(E=f),a}function y(){var a,c,e,f,g,h,i,j,k;for(i=E,j=E,a=[],/^[0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[0-9]"));null!==c;)a.push(c),/^[0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[0-9]"));if(null!==a)if(46===b.charCodeAt(E)?(c=".",E++):(c=null,0===F&&d('"."')),null!==c){if(/^[0-9]/.test(b.charAt(E))?(f=b.charAt(E),E++):(f=null,0===F&&d("[0-9]")),null!==f)for(e=[];null!==f;)e.push(f),/^[0-9]/.test(b.charAt(E))?(f=b.charAt(E),E++):(f=null,0===F&&d("[0-9]"));else e=null;if(null!==e){if(k=E,/^[Ee]/.test(b.charAt(E))?(f=b.charAt(E),E++):(f=null,0===F&&d("[Ee]")),null!==f){if(/^[0-9]/.test(b.charAt(E))?(h=b.charAt(E),E++):(h=null,0===F&&d("[0-9]")),null!==h)for(g=[];null!==h;)g.push(h),/^[0-9]/.test(b.charAt(E))?(h=b.charAt(E),E++):(h=null,0===F&&d("[0-9]"));else g=null;null!==g?f=[f,g]:(f=null,E=k)}else f=null,E=k;f=null!==f?f:"",null!==f?a=[a,c,e,f]:(a=null,E=j)}else a=null,E=j}else a=null,E=j;else a=null,E=j;if(null!==a&&(a=function(a,b){return parseFloat(_.flatten(b).join(""))}(i,a)),null===a&&(E=i),null===a){if(i=E,j=E,/^[a-fA-F0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[a-fA-F0-9]")),null!==c)for(a=[];null!==c;)a.push(c),/^[a-fA-F0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[a-fA-F0-9]"));else a=null;if(null!==a?(/^[hH]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[hH]")),null!==c?a=[a,c]:(a=null,E=j)):(a=null,E=j),null!==a&&(a=function(a,b){return parseInt(_.flatten(b).join(""),16)}(i,a[0])),null===a&&(E=i),null===a){if(i=E,j=E,/^[0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[0-9]")),null!==c)for(a=[];null!==c;)a.push(c),/^[0-9]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[0-9]"));else a=null;null!==a?(/^[dD]/.test(b.charAt(E))?(c=b.charAt(E),E++):(c=null,0===F&&d("[dD]")),c=null!==c?c:"",null!==c?a=[a,c]:(a=null,E=j)):(a=null,E=j),null!==a&&(a=function(a,b){return parseInt(_.flatten(b).join(""),10)}(i,a[0])),null===a&&(E=i)}}return a}function z(){var a;return/^[' '\t\r\n]/.test(b.charAt(E))?(a=b.charAt(E),E++):(a=null,0===F&&d("[' '\\t\\r\\n]")),a}function A(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function B(){for(var a=1,c=1,d=!1,e=0;e<Math.max(E,G);e++){var f=b.charAt(e);"\n"===f?(d||a++,c=1,d=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(a++,c=1,d=!0):(c++,d=!1)}return{line:a,column:c}}function C(a,b){var c=a;return _.each(b,function(a){c=new n(a[1],c,a[3])}),c}var D={program:e,statement:g,unary_ops:h,additive_ops:i,multiplicative_ops:j,boolean_ops:k,boolean_expr:l,additive_expr:m,multiplicative_expr:t,unary:u,func_call:v,primary_expr:w,identifier:x,value:y,sep:z};if(void 0!==c){if(void 0===D[c])throw new Error("Invalid rule name: "+a(c)+".")}else c="program";var E=0,F=0,G=0,H=[],I=D[c]();if(null===I||E!==b.length){var J=Math.max(E,G),K=J<b.length?b.charAt(J):null,L=B();throw new this.SyntaxError(A(H),K,J,L.line,L.column)}return I},toSource:function(){return this._source}};return b.SyntaxError=function(b,c,d,e,f){function g(b,c){var d,e;switch(b.length){case 0:d="end of input";break;case 1:d=b[0];break;default:d=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}return e=c?a(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=b,this.found=c,this.message=g(b,c),this.offset=d,this.line=e,this.column=f},b.SyntaxError.prototype=Error.prototype,b}(),a(t,j,{init:function(){var a=this.gl;this.destTextureLocation=a.getUniformLocation(this.program,"u_destTexture"),t.super.init.call(this)},update:function(a,b){var c=this.gl;b&&(c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,b),c.uniform1i(this.destTextureLocation,1)),t.super.update.call(this,a)}}),a(u,h,{swapFrame:!0,_constructComponent:function(a){for(var b=[],c=0;c<a.length;c++)if("boolean"!=typeof a[c].enabled||a[c].enabled){var d=a[c].type,e=new g[d](a[c]);b.push(e)}this.components=b},initComponent:function(a,b,c){u.super.initComponent.call(this,a,b,c),this._initFrameBuffer();for(var d=this.components,e=new t(this.output),f=[],g=0;g<d.length;g++){var h=d[g].initComponent(a,b,c);h&&f.push(h)}return e.initComponent(a,this.resolution,c),this.copyComponent=e,D.all(f)},updateComponent:function(a){u.super.updateComponent.call(this,a);var b=this.gl,c=b.getParameter(b.FRAMEBUFFER_BINDING);b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffer),b.viewport(0,0,this.resolution.width,this.resolution.height),this._setFBAttachment(),(this.clearFrame||this.first)&&(b.clearColor(0,0,0,1),b.clear(b.COLOR_BUFFER_BIT),this.first=!1);for(var d=this.components,f=0;f<d.length;f++){var g=d[f];if(b.useProgram(g.program),g.swapFrame){var h=this._getCurrentTextrue();this._swapFBAttachment(),g.updateComponent(h)}else g.updateComponent()}b.bindFramebuffer(b.FRAMEBUFFER,c),b.useProgram(this.copyComponent.program),b.viewport(0,0,this.resolution.width,this.resolution.height),e(a||this.output==F.REPLACE,"Cannot blend"),this.copyComponent.updateComponent(this.frameAttachments[this.currAttachment].texture,a)},destroyComponent:function(){u.super.destroyComponent.call(this);var a,b=this.gl;for(a=0;a<this.components.length;a++)this.components[a].destroyComponent();for(this.copyComponent.destroyComponent(),a=0;2>a;a++)b.deleteRenderbuffer(this.frameAttachments[a].renderbuffer),b.deleteTexture(this.frameAttachments[a].texture);b.deleteFramebuffer(this.framebuffer)},_initFrameBuffer:function(){for(var a=this.gl,b=a.createFramebuffer(),c=[],d=0;2>d;d++){var e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.resolution.width,this.resolution.height,0,a.RGBA,a.UNSIGNED_BYTE,null);var f=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,f),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,this.resolution.width,this.resolution.height),c[d]={texture:e,renderbuffer:f}}this.framebuffer=b,this.frameAttachments=c,this.currAttachment=0},_setFBAttachment:function(){var a=this.frameAttachments[this.currAttachment],b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a.texture,0),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a.renderbuffer)},_getCurrentTextrue:function(){return this.frameAttachments[this.currAttachment].texture},_swapFBAttachment:function(){this.currAttachment=(this.currAttachment+1)%2,this._setFBAttachment()}}),window.Webvs.EffectList=u,a(v,Object,{isPlaying:function(){return this.dancer.isPlaying()},getWaveform:function(){return this.dancer.getWaveform()},getSpectrum:function(){return this.dancer.getSpectrum()}}),window.Webvs.DancerAdapter=v,a(w,i,{init:function(){var a=this.gl;this.vertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),a.STATIC_DRAW),this.positionLocation=a.getAttribLocation(this.program,"a_position"),this.colorLocation=a.getUniformLocation(this.program,"u_color")},update:function(){var a=this.gl,b=!1;this.analyser.beat&&!this.prevBeat&&(this.beatCount++,this.beatCount==this.n&&(b=!0,this.beatCount=0)),this.prevBeat=this.analyser.beat,b&&(this.blend&&(a.enable(a.BLEND),a.blendColor(.5,.5,.5,1),a.blendFunc(a.CONSTANT_COLOR,a.CONSTANT_COLOR)),a.uniform3fv(this.colorLocation,this.color),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.enableVertexAttribArray(this.positionLocation),a.vertexAttribPointer(this.positionLocation,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6),this.blend&&a.disable(a.BLEND))},destroyComponent:function(){w.super.destroyComponent.call(this),this.gl.deleteBuffer(this.vertexBuffer)}}),window.Webvs.OnBeatClear=w,a(x,i,{init:function(){var a=this.gl,b=a.createTexture(),c=D(),d=new Image;d.src=this.src,this.imageTexture=b;var e=this;return d.onload=function(){e.imageResolution=[d.width,d.height],a.bindTexture(a.TEXTURE_2D,b),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),c.resolve()},this.texCoordBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),a.STATIC_DRAW),this.imageLocation=a.getUniformLocation(this.program,"u_image"),this.imagePosLocation=a.getUniformLocation(this.program,"u_imagePos"),this.imageResLocation=a.getUniformLocation(this.program,"u_imageResolution"),this.texCoordLocation=a.getAttribLocation(this.program,"a_texCoord"),c.promise},update:function(){var a=this.gl;a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.imageTexture),a.uniform1i(this.imageLocation,0),a.uniform2f(this.imagePosLocation,this.x,this.y),a.uniform2f(this.imageResLocation,this.imageResolution[0],this.imageResolution[1]),a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffer),a.enableVertexAttribArray(this.texCoordLocation),a.vertexAttribPointer(this.texCoordLocation,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6)},destroyComponent:function(){x.super.destroyComponent.call(this);var a=this.gl;a.deleteTexture(this.imageTexture),a.dleteBuffer(this.texCoordBuffer)}}),window.Webvs.Picture=x,a(y,i,{init:function(){var a=this.gl;this.code.w=this.resolution.width,this.code.h=this.resolution.height,this.pointBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer(),this.vertexPositionLocation=a.getAttribLocation(this.program,"a_position"),this.vertexColorLocation=a.getAttribLocation(this.program,"a_color"),this.pointSizeLocation=a.getUniformLocation(this.program,"u_pointSize")},update:function(){var a=this.gl,b=this.code;this._stepColor(),b.red=this.currentColor[0],b.green=this.currentColor[1],b.blue=this.currentColor[2],this.inited||(b.init(),this.inited=!0);var c=this.analyser.beat;
b.b=c?1:0,b.perFrame(),c&&b.onBeat();for(var d=Math.floor(b.n),e=this.spectrum?this.analyser.getSpectrum():this.analyser.getWaveform(),f=e.length/d,g=0,h=0,i=new Float32Array(2*(this.dots?d:2*d-2)),j=new Float32Array(3*(this.dots?d:2*d-2)),k=0;d>k;k++){for(var l=0,m=0,n=Math.floor(k*f);(k+1)*f>n;n++,m++)l+=e[n];l/=m;var o=k/(d-1);b.i=o,b.v=l,b.perPoint(),i[g++]=b.x,i[g++]=-1*b.y,j[h++]=b.red,j[h++]=b.green,j[h++]=b.blue,0===k||k==d-1||this.dots||(i[g++]=b.x,i[g++]=-1*b.y,j[h++]=b.red,j[h++]=b.green,j[h++]=b.blue)}a.uniform1f(this.pointSizeLocation,this.thickness),a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer),a.bufferData(a.ARRAY_BUFFER,i,a.STATIC_DRAW),a.enableVertexAttribArray(this.vertexPositionLocation),a.vertexAttribPointer(this.vertexPositionLocation,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer),a.bufferData(a.ARRAY_BUFFER,j,a.STATIC_DRAW),a.enableVertexAttribArray(this.vertexColorLocation),a.vertexAttribPointer(this.vertexColorLocation,3,a.FLOAT,!1,0,0);var p;this.dots||(p=a.getParameter(a.LINE_WIDTH),a.lineWidth(this.thickness)),a.drawArrays(this.dots?a.POINTS:a.LINES,0,g/2),this.dots||a.lineWidth(p)},destroyComponent:function(){y.super.destroyComponent.call(this);var a=this.gl;a.deleteBuffer(this.vertexBuffer),a.deleteBuffer(this.colorBuffer)},_stepColor:function(){var a;if(this.colors.length>1)if(this.step==this.maxStep){var b=this.colors[this.colorId];this.colorId=(this.colorId+1)%this.colors.length;var c=this.colors[this.colorId];for(a=0;3>a;a++)this.colorStep[a]=(c[a]-b[a])/this.maxStep;this.step=0,this.currentColor=b}else{for(a=0;3>a;a++)this.currentColor[a]+=this.colorStep[a];this.step++}}}),y.examples={diagonalScope:{init:"n=64; t=1;",onBeat:"t=-t;",perPoint:"sc=0.4*sin(i*$PI); x=2*(i-0.5-v*sc)*t; y=2*(i-0.5+v*sc);"}},window.Webvs.SuperScope=y,z.kernels={normal:[0,0,0,0,1,0,0,0,0],gaussianBlur:[.045,.122,.045,.122,.332,.122,.045,.122,.045],unsharpen:[-1,-1,-1,-1,9,-1,-1,-1,-1],emboss:[-2,-1,0,-1,1,1,0,1,2],blur:[1,1,1,1,1,1,1,1,1]},a(z,j,{init:function(){var a=this.gl;this.kernelLocation=a.getUniformLocation(this.program,"u_kernel[0]"),this.kernelWeightLocation=a.getUniformLocation(this.program,"u_kernelWeight"),z.super.init.call(this)},update:function(a){var b=this.gl;b.uniform1fv(this.kernelLocation,this.kernel),b.uniform1f(this.kernelWeightLocation,this.kernelWeight),z.super.update.call(this,a)}}),window.Webvs.Convolution=z,a(A,i,{swapFrame:!0,init:function(){var a=this.gl;this.code.w=this.resolution.width,this.code.h=this.resolution.height,this.pointBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer);for(var b=2*(this.gridW/this.resolution.width),c=2*(this.gridH/this.resolution.height),d=Math.ceil(this.resolution.width/this.gridW),e=Math.ceil(this.resolution.height/this.gridH),f=new Float32Array(2*6*d*e),g=0,h=-1,i=-1,j=0;e>j;j++){for(var k=0;d>k;k++){var l=Math.min(h+b,1),m=Math.min(i+c,1);f[g++]=h,f[g++]=i,f[g++]=l,f[g++]=i,f[g++]=h,f[g++]=m,f[g++]=l,f[g++]=i,f[g++]=l,f[g++]=m,f[g++]=h,f[g++]=m,h+=b}h=-1,i+=c}a.bufferData(a.ARRAY_BUFFER,f,a.STATIC_DRAW),this.pointBufferSize=g/2,this.vertexPositionLocation=a.getAttribLocation(this.program,"a_position"),this.curRenderLocation=a.getUniformLocation(this.program,"u_curRender")},update:function(a){var b=this.gl,c=this.code;this.inited||(c.init(),this.inited=!0);var d=this.analyser.beat;c.b=d?1:0,c.perFrame(),d&&c.onBeat(),this.code.bindUniforms(b,this.program,["x","y","d","r"]),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,a),b.uniform1i(this.curRenderLocation,0),b.bindBuffer(b.ARRAY_BUFFER,this.pointBuffer),b.enableVertexAttribArray(this.vertexPositionLocation),b.vertexAttribPointer(this.vertexPositionLocation,2,b.FLOAT,!1,0,0),b.drawArrays(b.TRIANGLES,0,this.pointBufferSize)}}),A.examples={inAndOut:{init:"speed=.2;c=0;",onBeat:["c = c + (3.141/2);","dd = 1 - (sin(c) * speed);"].join("\n"),perPixel:"d = d * dd;"},randomDirection:{init:"speed=.05;dr = (rand(200) / 100) * 3.141;",perFrame:["dx = cos(dr) * speed;","dy = sin(dr) * speed;"].join("\n"),onBeat:"dr = (rand(200) / 100) * 3.141;",perPixel:["x = x + dx;","y = y + dy;"].join("\n")},rollingGridley:{init:"c=200;f=0;dt=0;dl=0;beatdiv=8",perFrame:["f = f + 1;","t = ((f * 3.141 * 2)/c)/beatdiv;","dt = dl + t;","dx = 14+(cos(dt)*8);","dy = 10+(sin(dt*2)*4);"].join("\n"),onBeat:"c=f;f=0;dl=dt",perPixel:"x=x+(sin(y*dx)*.03); y=y-(cos(x*dy)*.03);"}},g.DynamicMovement=A,a(B,i,{init:function(){var a=this.gl;this.vertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),a.STATIC_DRAW),this.positionLocation=a.getAttribLocation(this.program,"a_position"),this.colorLocation=a.getUniformLocation(this.program,"u_color")},update:function(){var a=this.gl;this.frameCount++,this.frameCount==this.maxFrameCount&&(this.frameCount=0,a.enable(a.BLEND),a.blendColor(.5,.5,.5,1),a.blendFunc(a.CONSTANT_COLOR,a.CONSTANT_COLOR),a.uniform3fv(this.colorLocation,this.color),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.enableVertexAttribArray(this.positionLocation),a.vertexAttribPointer(this.positionLocation,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,6),a.disable(a.BLEND))},destroyComponent:function(){B.super.destroyComponent.call(this),this.gl.deleteBuffer(this.vertexBuffer)}}),window.Webvs.FadeOut=B}();